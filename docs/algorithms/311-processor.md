# ABT-3.1.1-Processor: 기본 언어 표시 v0.20

### 🔗 References
- KWCAG 2.2: 3.1.1 기본 언어 표시
- WCAG 2.2: 3.1.1 Language of Page (A) (Reference)

---

이 알고리즘은 **KWCAG 3.1.1(기본 언어 표시)** 지침을 준수하며, 웹 페이지의 최상위 요소(`<html>`)에 문서가 주로 사용하는 기본 언어가 올바르고 명확하게 정의되어 있는지 진단합니다. 스크린 리더가 올바른 언어의 음성 합성 엔진(TTS)을 선택할 수 있도록 보장합니다.

## 1. 대상 식별 및 데이터 수집 (Data Collection)

### [대상 요소 추출]
- 페이지 최상위 루트 요소: `<html>` 태그

### [데이터 속성 파악]
- 우선순위 1: `<html>` 요소의 `lang` 속성 값
- 우선순위 2: `<html>` 요소의 `xml:lang` 속성 값 (오래된 XHTML 지원)

## 2. 분석 및 분류 로직 (Analysis Pipeline)

### [단계 A] 속성 존재 여부 검사
- `lang` 또는 `xml:lang` 속성이 존재하는가?
- 결과: 속성 자체가 없거나 비어 있으면 **[오류]**.

### [단계 B] 언어 코드 유효성 검사 (BCP 47 Validity & Whitelist)
- **1단계**: 명시된 언어 코드가 표준 규격(BCP 47) 정규식 형식을 만족하는가?
  - 결과: 형식이 틀린 경우(예: `lang="korea"`) **[오류]**.
  - **2단계**: 형식을 만족하더라도, **자주 사용되는 언어 코드 화이트리스트**에 포함되는가?
  - 화이트리스트: `ko`, `en`, `ja`, `zh`, `fr`, `de`, `es`, `it`, `pt`, `vi`, `th`, `ru` 및 각국의 주요 지역 코드(`ko-KR`, `en-US` 등)
  - 결과: 화이트리스트에 없는 코드일 경우 오타나 비표준 코드일 가능성이 있으므로 상세한 **[검토 필요]** 안내 제공.
### [단계 C] 콘텐츠 언어 일치 검토 (정성 평가)
  - 명시된 유효한 언어 코드와 실제 페이지의 주요 텍스트 콘텐츠 언어가 일치하는가?
  - 브라우저 환경에서 실제 언어 비율을 완벽히 계산하는 것은 한계가 있으므로, 기계적 속성 검증이 통과되더라도 최종적으로 사람이 확인하도록 유도합니다.
- 결과: 유효한 코드가 있을 경우 항상 **[검토 필요]** 리포트를 발행하여 최종 점검을 요청합니다.

## 3. 최종 상태 정의 (Final Status)
1. **오류 (Fail):**
   - `<html>` 태그에 `lang` 속성이 제공되지 않음.
   - `lang` 속성 값이 비어 있음.
   - `lang` 속성 값이 BCP 47 언어 코드 정규식 형식을 위반함.
2. **검토 필요 (Needs Review):**
   - (Case 1) 유효한 BCP 47 형식이지만 **자주 쓰이는 목록에 없을 때**: 오타 의심 및 실제 본문 언어 불일치 여부 확인 요청.
   - (Case 2) **자주 쓰이는 목록에 있을 때**: 속성은 완벽하나, 실제 본문 텍스트의 주 언어와 일치하는지는 사람의 최종 확인이 필요하므로 안내.